<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta http-equiv="Pragma" content="no-cache">
		<title>注册</title>
		<link rel="stylesheet" href="cropbox.js/css/app.min.css" />
		<link rel="stylesheet" href="cropbox.js/css/style2.css" />
		<link rel="stylesheet" href="js/easyform/easyform.css" />
		<link rel="stylesheet" href="css/base-reset.css" />
		<link rel="stylesheet" href="css/bootstrap.min.css" />
		<link rel="stylesheet" href="css/public.css" />
		<link rel="stylesheet" href="css/yhn.css" />
		<script src="js/jquery-1.11.3.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<script src="js/vue.min.js"></script>
		<script src="js/easyform/easyform.js"></script>
		<script src="js/Validform_v5.3.2.js"></script>
	</head>
	<style>
		.form-control:focus {
			border: none;
			outline: none;
			box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
		}
	</style>
	<style>
		.Validform_checktip {
			margin-left: 8px !important;
			line-height: 20px !important;
			height: 20px !important;
			overflow: hidden !important;
			color: #999 !important;
			font-size: 12px !important;
		}
		
		.Validform_right {
			color: #71b83d !important;
			padding-left: 30px !important;
			background: url(img/right.png) no-repeat 10px center !important;
		}
		
		.Validform_wrong {
			color: #e4393c !important;
			padding-left: 30px !important;
			white-space: nowrap !important;
			background: url(img/wrong.png) no-repeat 10px center !important;
		}
		
		.Validform_loading {
			padding-left: 20px !important;
			background: url(images/onLoad.gif) no-repeat left center !important;
		}
		
		.Validform_error {
			background-color: #ffe7e7 !important;
		}
		
		.Validform_msg {
			display: none !important;
		}
		
		#Validform_msg {
			position: absolute;
			top: 0;
			left: 0;
			z-index: -999;
		}
	</style>

	<body>
		<header class="navbar navbar-default" id="top" role="banner" style="margin-top:20px">
			<div class="container">
				<img class="logo left" src="img/logo.png" />
				<div id="navbar" class="navbar-collapse collapse" style='padding-right:0'>
					<ul class="nav navbar-nav">
						<li class="">
							<a href="index.html">主页</a>
						</li>
						<li class="">
							<a href="selectFun.html">自助评估</a>
						</li>
						<li class="">
							<a href="projectApplication.html">项目申请</a>
						</li>
						<li class="">
							<a href="together.html">合作条款</a>
						</li>
						<li class="">
							<a href="aboutUs.html">关于我们</a>
						</li>
					</ul>
					<ul class="nav navbar-nav navbar-right">
						<li>
							<a href="login.html">登录</a>
						</li>
						<li class="active">
							<a href="register.html">注册</a>
						</li>
					</ul>
				</div>
			</div>
		</header>

		<form id="scope">
			<div class="login-head w1170">
				<span class="left logintitle">注册悠米技术风投</span>
				<a href="login.html"><span class="right">使用已有账号登录</span></a>
			</div>
			<div class="login-box">
				<select class="form-control" style="width:100%;height:50px;font-size:16px">
					<option selected="selected">中国大陆（+86）</option>
				</select>
				<div class="input-group input-group-lg" style="margin-top:30px">
					<span class="input-group-addon" style="background:#F4F7FA;border:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);"><span class="glyphicon glyphicon-earphone"></span></span>
					<input id="userPhone" v-model="postData.mobile" style="background:#F4F7FA;border:none;" type="text" class="form-control kup" placeholder="请输入手机号">
					<span id="testPhone" class="Validform_checktip input-group-addon" style="padding-left:30px;border:none;background:#F4F7FA;box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);"></span>
				</div>

				<div class="input-group input-group-lg" style="margin-top:30px">
					<span class="input-group-addon" style="background:#F4F7FA;border:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);"><span class="glyphicon glyphicon-user"></span></span>
					<input v-model="postData.name" style="background:#F4F7FA;border:none;" type="text" class="form-control kup" placeholder="请输入昵称" datatype="*2-10">
					<span class="Validform_checktip input-group-addon" style="padding-left:30px;border:none;background:#F4F7FA;box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);"></span>
				</div>

				<div class="input-group input-group-lg" style="margin-top:30px;">
					<span style="background:#F4F7FA;border:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);" class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
					<input id="pwd" v-model="postData.passwordA" style="background:#F4F7FA;border:none;" type="password" class="form-control kup" placeholder="输入密码" name="pwd" datatype="*6-18">
					<span class="Validform_checktip input-group-addon" style="padding-left:30px;border:none;background:#F4F7FA;box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);"></span>
				</div>

				<div class="input-group input-group-lg" style="margin-top:30px;">
					<span style="background:#F4F7FA;border:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);" class="input-group-addon"><span class="glyphicon glyphicon-lock"></span></span>
					<input v-model="postData.password" style="background:#F4F7FA;border:none;" type="password" class="form-control kup" placeholder="确认密码" recheck="pwd" datatype="*6-18">
					<span class="Validform_checktip input-group-addon" style="padding-left:30px;border:none;background:#F4F7FA;box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);"></span>
				</div>
				<div>
					<div class="left input-group input-group-lg" style="margin-top:30px;width:280px;">
						<span style="background:#F4F7FA;border:none;box-shadow:inset 0 1px 1px rgba(0,0,0,.075);" class="input-group-addon"><span class="glyphicon glyphicon-eye-open"></span></span>
						<input v-model="postData.code" style="background:#F4F7FA;border:none;" type="text" class="form-control" placeholder="验证码">
					</div>
					<div class="right input-group input-group-lg" style="margin-top:30px;width:200px;">
						<button  type="button" class="btn btn-default sendCodeBtn" style="width:100%;height:46px;">发送验证码</button>
					</div>
				</div>
				<div class="clear"></div>
				<button id="confirm" type="button" class="btn btn-primary login-Btn">注册账号</button>
			</div>
		</form>
		<footer id="footer"></footer>
	</body>
	<script type="text/javascript" src="layer/layer.js" ></script>
	<script>
	$("#footer").load("footer.html");
		var vm = new Vue({
			el: '#scope',
			data: {
				postData: {
					mobile: '',
					password: '',
					passwordA: "",
					name: '',
					code:""
				},
				checkData: "^bucketccv.bmc.vmb.,dlkfgjl$"
			},
		});

		var interval;
		var k = 90;

		$(".sendCodeBtn").on('click', function() {
			if($("#userPhone").val() == ""){
				layer.msg("请输入手机号");
				return;
			}
			if($("#testPhone").prev().hasClass("Validform_error")){
				layer.msg("手机号码输入错误");
				return;
			}
			startTime();
			sendCode();
		})

		function startTime() {
			$(".sendCodeBtn").text("发送验证码(" + k + ")");
			$(".sendCodeBtn").attr('disabled', 'disabled')
			interval = setInterval(function() {
				k--;
				$(".sendCodeBtn").text("发送验证码(" + k + ")");
				if(k == 0) {
					clearInterval(interval);
					k = 90;
					$(".sendCodeBtn").removeAttr('disabled')
					$(".sendCodeBtn").text("发送验证码");
				}
			}, 1000);
		}
		
		var verifyCode = "";
		function sendCode() {
			$.ajax({
				type: "post",
				url: "/services/ws/auth/sendAuthCode",
				contentType: "application/json",
				data: JSON.stringify({
					mobile: $("#userPhone").val(),
					type : 'register'
				}),
				success: function(jsonData) {
					console.log(jsonData);
					var data = $.parseJSON(jsonData);
					if(data.status == "false") {
						layer.msg(data.msg);
					}
				}
			});
		}

		$("#confirm").click(function() {
			console.log(JSON.stringify(vm.postData));
			if($("#form1").Validform().check()) {
				$.ajax({
					type: "post",
					url: "/services/ws/res/register",
					contentType: "application/json",
					data: JSON.stringify(vm.postData),
					success: function(jsonData) {
						console.log(jsonData);
						var data = $.parseJSON(jsonData);
						if(data.status == "true") {
							layer.msg("注册成功！");
							window.location.href = "login.html";
						}else{
							layer.msg(data.msg);
						}
					}
				});
			}
		});

		$("#userPhone").focusout(function() {
			var mobile = vm.postData.mobile;
			$.ajax({
				type: "get",
				url: "/services/ws/res/check",
				contentType: "application/json",
				data: {
					mobile: mobile
				},
				success: function(jsonData) {
					var data = $.parseJSON(jsonData);
					if(data.status == "false") {
						$("#testPhone").addClass("Validform_wrong").text("手机号已注册！");
						$("#testPhone").prev().addClass("Validform_error");
					} else {
						if((/^1[3|4|5|7|8]\d{9}$/.test(mobile))) {
							$("#testPhone").prev().removeClass("Validform_error");
							$("#testPhone").removeClass("Validform_wrong").addClass("Validform_right").text("通过信息验证！");
						} else {
							$("#testPhone").removeClass("Validform_right").addClass("Validform_wrong").text("手机号有误！");
							$("#testPhone").prev().addClass("Validform_error");
						}
					}
				}
			});
		});

		//表单验证初始化
		$("#scope").Validform({
			tiptype: function(msg, o, cssctl) {
				if(!o.obj.is("form")) {
					var objtip = o.obj.siblings(".Validform_checktip");
					cssctl(objtip, o.type);
					objtip.text(msg);
				}
			},

		});
		//按键弹起 检查
		/*$(".kup").on("keyup",function(){
			var me=this.id;
			console.log(me);
			$("#form1").Validform().check(false,"#"+me);
		});*/
	</script>

</html>