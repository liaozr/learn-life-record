<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
</head>
<body>

å˜é‡çš„å—çº§ä½œç”¨åŸŸ

ä½¿ç”¨ ES6ï¼Œå£°æ˜å˜é‡æˆ‘ä»¬å¯ä»¥ç”¨ var ï¼Œä¹Ÿå¯ä»¥ç”¨ let æˆ– constã€‚

var æœ‰ä»€ä¹ˆä¸è¶³ï¼Ÿ
ä½¿ç”¨ var çš„é—®é¢˜æ˜¯å˜é‡ä¼šæ¼å…¥å…¶ä»–ä»£ç å—ä¸­ï¼Œè¯¸å¦‚ for å¾ªç¯æˆ– if ä»£ç å—ã€‚

<script>
    // ES5
    var x = 'outer';

    function test(inner) {
        if (inner) {
            var x = 'inner'; // ä½œç”¨äºæ•´ä¸ª function
            console.log(x); //inner
            return x;
        }
        console.log(x); // undefined
        return x; // å› ä¸ºç¬¬å››è¡Œçš„å£°æ˜æå‡ï¼Œè¢«é‡æ–°å®šä¹‰
    }
    test(false); // undefined ğŸ˜±
    test(true); // inner
</script>


å¯¹äº test(fasle) ï¼Œä½ æœŸæœ›è¿”å› outerï¼Œä½†æ˜¯ï¼Œä½ å¾—åˆ°çš„æ˜¯ undefinedã€‚
ä¸ºä»€ä¹ˆï¼Ÿ
å› ä¸ºå°½ç®¡æ²¡æœ‰æ‰§è¡Œ if ä»£ç å—ï¼Œç¬¬å››è¡Œä¸­çš„è¡¨è¾¾å¼ var x ä¹Ÿä¼šè¢«æå‡ã€‚

var æå‡ï¼š

var æ˜¯å‡½æ•°ä½œç”¨åŸŸã€‚åœ¨æ•´ä¸ªå‡½æ•°ä¸­ç”šè‡³æ˜¯å£°æ˜è¯­å¥ä¹‹å‰éƒ½æ˜¯å¯ç”¨çš„ã€‚

å£°æ˜è¢«æå‡ã€‚æ‰€ä»¥ä½ èƒ½åœ¨å£°æ˜ä¹‹å‰ä½¿ç”¨ä¸€ä¸ªå˜é‡ã€‚

åˆå§‹åŒ–æ˜¯ä¸è¢«æå‡çš„ã€‚å¦‚æœä½ ä½¿ç”¨ var å£°æ˜å˜é‡ï¼Œè¯·æ€»æ˜¯å°†å®ƒæ”¾åœ¨é¡¶éƒ¨ã€‚

åœ¨åº”ç”¨äº†å£°æ˜æå‡è§„åˆ™ä¹‹åï¼Œæˆ‘ä»¬å°±èƒ½æ›´å®¹æ˜“åœ°ç†è§£å‘ç”Ÿäº†ä»€ä¹ˆï¼š

<script>
    // ES5
    var x = 'outer';

    function test(inner) {
        var x; // å£°æ˜æå‡
        if (inner) {
            x = 'inner'; // åˆå§‹åŒ–ä¸è¢«æå‡
            return x;
        }
        return x;
    }
</script>

<!-- -------------------------------------------------------------------------------- -->

ECMAScript 2015 æ‰¾åˆ°äº†è§£å†³çš„åŠæ³•ï¼š

<script>
    // ES6
    let xx = 'outer';

    function test(inner) {
        if (inner) {
            let xx = 'inner';
            return x;
        }
        console.log(xx)  //è¾“å‡ºçš„æ˜¯outer
        
        return xx; // ä»ç¬¬ä¸€è¡Œè·å–åˆ°é¢„æœŸç»“æœ
    }
    test(false); // outer
    test(true); // inner
</script>

å°† var æ”¹ä¸º letï¼Œä»£ç å°†åƒæœŸæœ›çš„é‚£æ ·è¿è¡Œã€‚

å¦‚æœ if ä»£ç å—æ²¡æœ‰è¢«è°ƒç”¨ï¼Œx å˜é‡ä¹Ÿå°±ä¸ä¼šåœ¨ä»£ç å—å¤–è¢«æå‡ã€‚

let æå‡ å’Œâ€œæš‚å­˜æ­»åŒºï¼ˆtemporal dead zoneï¼‰â€


åœ¨ ES6 ä¸­ï¼Œlet å°†å˜é‡æå‡åˆ°ä»£ç å—çš„é¡¶éƒ¨ï¼ˆä¸æ˜¯åƒ ES5 é‚£æ ·çš„å‡½æ•°é¡¶éƒ¨ï¼‰ã€‚

ç„¶è€Œï¼Œä»£ç å—ä¸­ï¼Œåœ¨å˜é‡å£°æ˜ä¹‹å‰å¼•ç”¨å®ƒä¼šå¯¼è‡´ ReferenceError é”™è¯¯ã€‚

let æ˜¯å—çº§ä½œç”¨åŸŸã€‚ä½ ä¸èƒ½åœ¨å®ƒè¢«å£°æ˜ä¹‹å‰å¼•ç”¨å®ƒã€‚

â€œæš‚å­˜æ­»åŒºï¼ˆTemporal dead zoneï¼‰â€æ˜¯æŒ‡ä»ä»£ç å—å¼€å§‹ç›´åˆ°å˜é‡è¢«å£°æ˜ä¹‹é—´çš„åŒºåŸŸã€‚

<!-- ---------------------------------------------------------------------------------- -->

</body>
</html>
